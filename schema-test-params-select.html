<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Rapport final - intervention en ergonomie - Arhoma - 2021-2022</title>
  <link rel="stylesheet" href="./style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  
  <link
  rel="stylesheet"
  href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"
/>
  <link rel="stylesheet" href="./style.css">
<!-- Vega-lite API -->
<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite-api@4"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-tooltip"></script>

<!-- Just Vega-Lite -->

<script src="https://cdn.jsdelivr.net/npm/vega@5.21.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5.2.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.20.2"></script>


</head>
<body>


  <div class="col">
    <div class="col">
      <div id="schema-lesions-par-departement"></div>
      <script>
        const spec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 350,
        "height": 250,
      title:{ text:"Par département et par type, 2013-2021",
      color:"#3e3c38",
      fontSize: 18,
    },
    "params": [{
    "name": "pts",
    "select": "interval",
    "fields": ["Nombre de lésions", "Département", "Type de lésion professionnelle"],
    "bind": "legend"

  }],
      
      "data": {
        "url": "https://gist.githubusercontent.com/GuillaumeLoslier/316d1f30a23778ca1705ee9e12c3d0cf/raw/1c9857da927a0ebaed9c78b5182c5f2b7cbe473a/lesions.csv"
      },
      "layer": [
        {
        "mark": "bar",
        "params": [{
        "name": "brush",
        "select": {"type": "interval", "encodings": ["x"]}
      }],
        "encoding": {
          "x": {
            "sort": "y",
          "field": "Type de lésion professionnelle",
          "type": "nominal",
          "title": "Type de lésion professionnelle",
          "axis": {
   "labelAngle": -20,
   "labelFontSize": 12,	
   "titleFontSize": 16,
   "labelLimit": 230,
          }
  
          },
          "y": {
          "field": "Nombre de lésions",
          "type": "quantitative",
          "title": "Nombre de lésions professionnelles",
          "axis": {
   "labelFontSize": 12,	
   "titleFontSize": 16,
          },
          "fillOpacity": {
      "condition": {"param": "select", "value": 1},
      "value": 0.3},
      },
  
  
          "color": {
            "condition": {
        "param": "pts",
        "field": "Département", "type": "nominal",
        "sort": "-x",
          "scale": {
            "domain": [
            "Boulangerie",
            "Cuisine",
            "Emballeur",
            "Entretien ménager",
            "Gérant de plancher",
            "Livraison",
            "Tourier-pâtissier"
            ],
            
      },
      "value": "grey"

          },

          
          "title": "Département"
          },
          "tooltip": [
          {"field": "Nombre de lésions", "type": "quantitative"},
          {"field": "Département", "type": "nominal"}
          ],


        }
        }
      ],
      

  }      ;
        vegaEmbed("#schema-lesions-par-departement", spec, {mode: "vega-lite"}).then(console.log).catch(console.warn);
      </script>
     </div>



  <!-- partial -->
  <script  src="./script.js"></script>

<!-- schéma -->
<!-- partial:index.partial.html -->
<script src="https://cdn.amcharts.com/lib/5/index.js"></script>
<script src="https://cdn.amcharts.com/lib/5/flow.js"></script>
<script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
<!-- partial -->

</body>
</html>
